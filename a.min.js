(function(){var a;var b=function(d,e){return function(){return d.apply(e,arguments)}},c=Array.prototype.indexOf||function(f){for(var e=0,d=this.length;e<d;e++){if(this[e]===f){return e}}return -1};a=(function(){function d(f,e){this.startButton=f;this.formInput=e;this.timerCount;this.maxWordLength=6;this.currentLevel=0;this.currentScore=0;this.currentWords=[];this.wordsGot=[];this.levelRunning=false;this.wordnik="03e4c5fc37b23b29ff30f0af73c00c5302cff40d81eb8b139";this.init()}d.prototype.init=function(){$("form").submit(function(f){return f.preventDefault()});$("#words").hide();return $(this.startButton).click(b(function(f){f.preventDefault();$(this.startButton).hide();return this.startLevel()},this))};d.prototype.collectWords=function(e){if(e==null){e=5}return $.ajax({url:"http://api.wordnik.com/v4/words.json/randomWords?hasDictionaryDef=true&limit="+e+"&maxLength="+this.maxWordLength+"&minLength=4&excludePartOfSpeech=abbreviation&includePartOfSpeech=adjective&api_key="+this.wordnik,dataType:"json",method:"get",async:false,success:b(function(j){var f,i,h,g;g=[];for(i=0,h=j.length;i<h;i++){f=j[i];g.push(this.currentWords.push(f.word.toLowerCase()))}return g},this)})};d.prototype.startLevel=function(){var g,e,f;$("#words").html("");$("#intro").html("");++this.currentLevel;if(this.maxWordLength<12){++this.maxWordLength}this.levelRunning=true;if(this.currentLevel<11){e=this.currentLevel*2}else{e=20}if(e<5){e=5}f=5000;g=30*1000;this.currentWords=[];this.collectWords(e);return this.flashWords(f,function(){this.activateTimer(30);this.showInput(g);return this.monitorInput(e)},this)};d.prototype.monitorInput=function(e){return $(this.formInput).keyup(b(function(){var f;f=$(this.formInput).val().toLowerCase();if(c.call(this.currentWords,f)>=0){this.wordsGot.push(f);this.currentScore++;$("#currentscore strong").text(this.currentScore);$(this.formInput).val("")}if(this.wordsGot.length===e){$(this.formInput).unbind();return this.endLevel(e)}},this))};d.prototype.activateTimer=function(e){return this.timerCount=window.setInterval(function(){$("#timer strong").text(":"+e);return e=e-1},1000)};d.prototype.deactivateTimer=function(){window.clearInterval(this.timerCount);return $("#timer strong").text(":")};d.prototype.endLevel=function(e){var f,g;this.levelRunning=false;this.hideInput();this.deactivateTimer();window.clearTimeout(this.inputTimeout);g=(e/5)*4;f=false;if(this.wordsGot.length>=g){f=true}if(f===true){$("#intro").text("Congratulations! You passed the Level");$("#currentscore strong").text(this.currentScore);this.advanceLevel()}if(f===false){$("#intro").text("Sorry, you lost the level. Your total score is displayed in the top right");return $("#currentscore strong").text(this.currentScore)}};d.prototype.advanceLevel=function(){$("#intro").text("On to Level "+(this.currentLevel+1)+". Get ready for more words but no more time!");this.wordsGot=[];return setTimeout(b(function(){return this.startLevel()},this),1000)};d.prototype.flashWords=function(j,k,g){var e,i,f,h;h=this.currentWords;for(i=0,f=h.length;i<f;i++){e=h[i];$("#words").append("<li>"+e+"</li>")}$("#words").slideDown();return setTimeout(function(){$("#words").slideUp();return k.call(g)},j)};d.prototype.showInput=function(e){if(e==null){e=0}$(this.formInput).parents("form").css("visibility","visible");$(this.formInput).focus();if(e!==0){return this.inputTimeout=setTimeout(b(function(){this.hideInput();if(this.levelRunning===true){return this.endLevel(this.currentWords.length)}},this),e)}};d.prototype.hideInput=function(){return $(this.formInput).parents("form").css("visibility","hidden")};return d})();window.game=new a("#startButton","#wordinput")}).call(this);